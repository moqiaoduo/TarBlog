"use strict";$(function(){$("a[data-function]").on("click",function(){var n=$(this).parent().parent().parent(),a=n.attr("data-id");switch($(this).attr("data-function")){case"edit":$.ajax({url:"do.php",method:"get",data:{a:"Admin/Comment/Info",id:a},dataType:"json",success:function(t){n.hide(),n.after($('\n                        <tr id="edit-comment" data-edit-id="'.concat(a,'">\n                            <td colspan="2">\n                                <div class="form-container">\n                                    <div class="form-group">\n                                        <div class="form-inline">\n                                            <label for="name" class="form-label">用户名</label>\n                                            <input type="text" class="form-control" id="name" value="').concat(t.name,'">\n                                        </div>\n                                    </div>\n                                    <div class="form-group">\n                                        <div class="form-inline">\n                                            <label for="email" class="form-label">电子邮箱</label>\n                                            <input type="email" class="form-control" id="email" \n                                            value="').concat(t.email?t.email:"",'">\n                                        </div>\n                                    </div>\n                                    <div class="form-group">\n                                        <div class="form-inline">\n                                            <label for="url" class="form-label">个人主页</label>\n                                            <input type="text" class="form-control" id="url"\n                                            value="').concat(t.url?t.url:"",'">\n                                        </div>\n                                    </div>\n                                </div>\n                            </td>\n                            <td>\n                                <div class="form-container">\n                                    <div class="form-group">\n                                        <textarea id="content" class="form-control input-block" rows="5"\n                                            style="resize:vertical;">').concat(t.content,'</textarea>\n                                    </div>\n                                    <div class="form-group">\n                                        <button type="button" data-function="edit-submit" class="btn btn-primary">提交</button>\n                                        <button type="button" data-function="edit-cancel" class="btn">取消</button>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>\n                        ')))},error:function(){console.log("ajax connect fail")}});break;case"reply":var t=$("#comment-reply-"+a);if(0<t.length)return void t.remove();var e=$('tr[data-id="'+a+'"]'),o=$(e.children("td").get(2));$(o.children(".comment-content")).append('<form method="post" id="comment-reply-'.concat(a,'" action="do.php?a=Admin/Comment/Reply&id=').concat(a,'">\n                    <p><textarea id="text" name="text" style="width: 90%;" rows="3" class="form-control"></textarea></p>\n                    <p><button type="submit" class="btn btn-primary btn-sm">回复</button>\n                    <button type="button" class="btn btn-sm" data-function="reply-cancel">取消</button></p>\n                    </form>'))}}),$(document).on("click","button[data-function]",function(){var e=$("#edit-comment"),o=e.attr("data-edit-id");switch($(this).attr("data-function")){case"edit-submit":$.ajax({url:"do.php?a=Admin/Comment/Modify",method:"post",data:{id:o,name:$("#name").val(),email:$("#email").val(),url:$("#url").val(),content:$("#content").val()},dataType:"json",success:function(t){var n=$('tr[data-id="'+o+'"]');$(n.children("td")[1]).children(".comment-avatar").children(".avatar").attr("src",t.avatar);var a=$(n.children("td")[1]).children(".comment-author");a.children(".email").html(t.email),a.children(".author").html(t.url?'<a href="'+t.url+'" target="_blank">'+t.name+"</a>":t.name),a.children(".ip").html(t.ip),$(n.children("td")[2]).children(".comment-content").html(t.content),n.show(),e.remove()},error:function(){alert("提交失败")}});break;case"edit-cancel":$('tr[data-id="'+o+'"]').show(),e.remove();break;case"reply-cancel":$(this).parent().parent().remove()}})});